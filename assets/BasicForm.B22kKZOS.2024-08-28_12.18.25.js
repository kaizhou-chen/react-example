import{r as h,h as J,u as Z,j as d}from"./index.DuhVyv5o.2024-08-28_12.18.25.js";import{d as ee,E as ne,c as W,i as H,_ as te,g as ie,m as ae,u as w,r as re,a as le,T as ce,C as se,X as oe,p as de,ac as ue,ab as T}from"./main.4nx9hMxs.2024-08-28_12.18.25.js";import"./http.C0GqneK9.2024-08-28_12.18.25.js";import{s as _}from"./index.CGeh4MOw.2024-08-28_12.18.25.js";import{F as C}from"./index.BeIEwkg_.2024-08-28_12.18.25.js";import{I as B}from"./index.CR4gxEfQ.2024-08-28_12.18.25.js";import{S as ge}from"./index.D589XKwz.2024-08-28_12.18.25.js";import{L as he}from"./Compact.CfzlR74k.2024-08-28_12.18.25.js";import{u as X}from"./index.BEjFr-Ao.2024-08-28_12.18.25.js";import{K as R}from"./KeyCode.DNlgD2sM.2024-08-28_12.18.25.js";import{W as me,B as D}from"./button.DQBKutpj.2024-08-28_12.18.25.js";import{u as pe}from"./useSize.Bsu5PhQC.2024-08-28_12.18.25.js";import{C as fe}from"./index.8o5rGnyl.2024-08-28_12.18.25.js";import{R as Se}from"./index.DaFsznVP.2024-08-28_12.18.25.js";import{S as be}from"./index.Cip_NC0s.2024-08-28_12.18.25.js";import{D as $e}from"./index.DyVaV9hn.2024-08-28_12.18.25.js";var Ce=["prefixCls","className","checked","defaultChecked","disabled","loadingIcon","checkedChildren","unCheckedChildren","onClick","onChange","onKeyDown"],K=h.forwardRef(function(e,n){var t,i=e.prefixCls,l=i===void 0?"rc-switch":i,c=e.className,o=e.checked,a=e.defaultChecked,r=e.disabled,s=e.loadingIcon,g=e.checkedChildren,p=e.unCheckedChildren,v=e.onClick,b=e.onChange,y=e.onKeyDown,x=ee(e,Ce),u=X(!1,{value:o,defaultValue:a}),m=ne(u,2),S=m[0],I=m[1];function j(f,E){var M=S;return r||(M=f,I(M),b==null||b(M,E)),M}function z(f){f.which===R.LEFT?j(!1,f):f.which===R.RIGHT&&j(!0,f),y==null||y(f)}function $(f){var E=j(!S,f);v==null||v(E,f)}var N=W(l,c,(t={},H(t,"".concat(l,"-checked"),S),H(t,"".concat(l,"-disabled"),r),t));return h.createElement("button",te({},x,{type:"button",role:"switch","aria-checked":S,disabled:r,className:N,ref:n,onKeyDown:z,onClick:$}),s,h.createElement("span",{className:"".concat(l,"-inner")},h.createElement("span",{className:"".concat(l,"-inner-checked")},g),h.createElement("span",{className:"".concat(l,"-inner-unchecked")},p)))});K.displayName="Switch";const ye=e=>{const{componentCls:n,trackHeightSM:t,trackPadding:i,trackMinWidthSM:l,innerMinMarginSM:c,innerMaxMarginSM:o,handleSizeSM:a,calc:r}=e,s=`${n}-inner`,g=w(r(a).add(r(i).mul(2)).equal()),p=w(r(o).mul(2).equal());return{[n]:{[`&${n}-small`]:{minWidth:l,height:t,lineHeight:w(t),[`${n}-inner`]:{paddingInlineStart:o,paddingInlineEnd:c,[`${s}-checked, ${s}-unchecked`]:{minHeight:t},[`${s}-checked`]:{marginInlineStart:`calc(-100% + ${g} - ${p})`,marginInlineEnd:`calc(100% - ${g} + ${p})`},[`${s}-unchecked`]:{marginTop:r(t).mul(-1).equal(),marginInlineStart:0,marginInlineEnd:0}},[`${n}-handle`]:{width:a,height:a},[`${n}-loading-icon`]:{top:r(r(a).sub(e.switchLoadingIconSize)).div(2).equal(),fontSize:e.switchLoadingIconSize},[`&${n}-checked`]:{[`${n}-inner`]:{paddingInlineStart:c,paddingInlineEnd:o,[`${s}-checked`]:{marginInlineStart:0,marginInlineEnd:0},[`${s}-unchecked`]:{marginInlineStart:`calc(100% - ${g} + ${p})`,marginInlineEnd:`calc(-100% + ${g} - ${p})`}},[`${n}-handle`]:{insetInlineStart:`calc(100% - ${w(r(a).add(i).equal())})`}},[`&:not(${n}-disabled):active`]:{[`&:not(${n}-checked) ${s}`]:{[`${s}-unchecked`]:{marginInlineStart:r(e.marginXXS).div(2).equal(),marginInlineEnd:r(e.marginXXS).mul(-1).div(2).equal()}},[`&${n}-checked ${s}`]:{[`${s}-checked`]:{marginInlineStart:r(e.marginXXS).mul(-1).div(2).equal(),marginInlineEnd:r(e.marginXXS).div(2).equal()}}}}}}},Ie=e=>{const{componentCls:n,handleSize:t,calc:i}=e;return{[n]:{[`${n}-loading-icon${e.iconCls}`]:{position:"relative",top:i(i(t).sub(e.fontSize)).div(2).equal(),color:e.switchLoadingIconColor,verticalAlign:"top"},[`&${n}-checked ${n}-loading-icon`]:{color:e.switchColor}}}},we=e=>{const{componentCls:n,trackPadding:t,handleBg:i,handleShadow:l,handleSize:c,calc:o}=e,a=`${n}-handle`;return{[n]:{[a]:{position:"absolute",top:t,insetInlineStart:t,width:c,height:c,transition:`all ${e.switchDuration} ease-in-out`,"&::before":{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,backgroundColor:i,borderRadius:o(c).div(2).equal(),boxShadow:l,transition:`all ${e.switchDuration} ease-in-out`,content:'""'}},[`&${n}-checked ${a}`]:{insetInlineStart:`calc(100% - ${w(o(c).add(t).equal())})`},[`&:not(${n}-disabled):active`]:{[`${a}::before`]:{insetInlineEnd:e.switchHandleActiveInset,insetInlineStart:0},[`&${n}-checked ${a}::before`]:{insetInlineEnd:0,insetInlineStart:e.switchHandleActiveInset}}}}},ve=e=>{const{componentCls:n,trackHeight:t,trackPadding:i,innerMinMargin:l,innerMaxMargin:c,handleSize:o,calc:a}=e,r=`${n}-inner`,s=w(a(o).add(a(i).mul(2)).equal()),g=w(a(c).mul(2).equal());return{[n]:{[r]:{display:"block",overflow:"hidden",borderRadius:100,height:"100%",paddingInlineStart:c,paddingInlineEnd:l,transition:`padding-inline-start ${e.switchDuration} ease-in-out, padding-inline-end ${e.switchDuration} ease-in-out`,[`${r}-checked, ${r}-unchecked`]:{display:"block",color:e.colorTextLightSolid,fontSize:e.fontSizeSM,transition:`margin-inline-start ${e.switchDuration} ease-in-out, margin-inline-end ${e.switchDuration} ease-in-out`,pointerEvents:"none",minHeight:t},[`${r}-checked`]:{marginInlineStart:`calc(-100% + ${s} - ${g})`,marginInlineEnd:`calc(100% - ${s} + ${g})`},[`${r}-unchecked`]:{marginTop:a(t).mul(-1).equal(),marginInlineStart:0,marginInlineEnd:0}},[`&${n}-checked ${r}`]:{paddingInlineStart:l,paddingInlineEnd:c,[`${r}-checked`]:{marginInlineStart:0,marginInlineEnd:0},[`${r}-unchecked`]:{marginInlineStart:`calc(100% - ${s} + ${g})`,marginInlineEnd:`calc(-100% + ${s} - ${g})`}},[`&:not(${n}-disabled):active`]:{[`&:not(${n}-checked) ${r}`]:{[`${r}-unchecked`]:{marginInlineStart:a(i).mul(2).equal(),marginInlineEnd:a(i).mul(-1).mul(2).equal()}},[`&${n}-checked ${r}`]:{[`${r}-checked`]:{marginInlineStart:a(i).mul(-1).mul(2).equal(),marginInlineEnd:a(i).mul(2).equal()}}}}}},ke=e=>{const{componentCls:n,trackHeight:t,trackMinWidth:i}=e;return{[n]:Object.assign(Object.assign(Object.assign(Object.assign({},re(e)),{position:"relative",display:"inline-block",boxSizing:"border-box",minWidth:i,height:t,lineHeight:w(t),verticalAlign:"middle",background:e.colorTextQuaternary,border:"0",borderRadius:100,cursor:"pointer",transition:`all ${e.motionDurationMid}`,userSelect:"none",[`&:hover:not(${n}-disabled)`]:{background:e.colorTextTertiary}}),le(e)),{[`&${n}-checked`]:{background:e.switchColor,[`&:hover:not(${n}-disabled)`]:{background:e.colorPrimaryHover}},[`&${n}-loading, &${n}-disabled`]:{cursor:"not-allowed",opacity:e.switchDisabledOpacity,"*":{boxShadow:"none",cursor:"not-allowed"}},[`&${n}-rtl`]:{direction:"rtl"}})}},xe=e=>{const{fontSize:n,lineHeight:t,controlHeight:i,colorWhite:l}=e,c=n*t,o=i/2,a=2,r=c-a*2,s=o-a*2;return{trackHeight:c,trackHeightSM:o,trackMinWidth:r*2+a*4,trackMinWidthSM:s*2+a*2,trackPadding:a,handleBg:l,handleSize:r,handleSizeSM:s,handleShadow:`0 2px 4px 0 ${new ce("#00230b").setAlpha(.2).toRgbString()}`,innerMinMargin:r/2,innerMaxMargin:r+a+a*2,innerMinMarginSM:s/2,innerMaxMarginSM:s+a+a*2}},Me=ie("Switch",e=>{const n=ae(e,{switchDuration:e.motionDurationMid,switchColor:e.colorPrimary,switchDisabledOpacity:e.opacityLoading,switchLoadingIconSize:e.calc(e.fontSizeIcon).mul(.75).equal(),switchLoadingIconColor:`rgba(0, 0, 0, ${e.opacityLoading})`,switchHandleActiveInset:"-30%"});return[ke(n),ve(n),we(n),Ie(n),ye(n)]},xe);var je=function(e,n){var t={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&n.indexOf(i)<0&&(t[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,i=Object.getOwnPropertySymbols(e);l<i.length;l++)n.indexOf(i[l])<0&&Object.prototype.propertyIsEnumerable.call(e,i[l])&&(t[i[l]]=e[i[l]]);return t};const Ee=h.forwardRef((e,n)=>{const{prefixCls:t,size:i,disabled:l,loading:c,className:o,rootClassName:a,style:r,checked:s,value:g,defaultChecked:p,defaultValue:v,onChange:b}=e,y=je(e,["prefixCls","size","disabled","loading","className","rootClassName","style","checked","value","defaultChecked","defaultValue","onChange"]),[x,u]=X(!1,{value:s??g,defaultValue:p??v}),{getPrefixCls:m,direction:S,switch:I}=h.useContext(se),j=h.useContext(oe),z=(l??j)||c,$=m("switch",t),N=h.createElement("div",{className:`${$}-handle`},c&&h.createElement(he,{className:`${$}-loading-icon`})),[f,E,M]=Me($),U=pe(i),Y=W(I==null?void 0:I.className,{[`${$}-small`]:U==="small",[`${$}-loading`]:c,[`${$}-rtl`]:S==="rtl"},o,a,E,M),G=Object.assign(Object.assign({},I==null?void 0:I.style),r),Q=function(){u(arguments.length<=0?void 0:arguments[0]),b==null||b.apply(void 0,arguments)};return f(h.createElement(me,{component:"Switch"},h.createElement(K,Object.assign({},y,{checked:x,onChange:Q,prefixCls:$,className:Y,style:G,disabled:z,ref:n,loadingIcon:N}))))}),V=Ee;V.__ANT_SWITCH=!0;async function F(e){let n=null;try{n=await e();let t=qe(n);if(t===null)return n;throw L("操作失败",t),new Error(t)}catch(t){throw L("请求失败",t.message),t}}function L(e,n){_.open({message:e+"<br>"+n})}function qe(e){if(!e)return"响应为空";if(e.status==200){if((e==null?void 0:e.data)==="")return e.data.message||"响应数据为空"}else{const n=e.data instanceof String?"<br>"+e.data:"";return"status: "+e.status+"<br>"+e.statusText+n}return null}let k=[{id:1,name:"五一促销活动",region:"shanghai",beginDate:"2024-05-01",endDate:"2024-05-03",jit:1,type:"2,3",resource:2,desc:"活动 1"},{id:2,name:"周末促销活动",region:"beijing",beginDate:"2024-05-04",endDate:"2024-05-05",jit:0,type:"2",resource:1,desc:"活动 2"}];function Pe(e){return new Promise(n=>{let{pageSize:t,pageNumber:i,orderBy:l}=e;t=t||10,i=i||1;let c=[],o=[],a=[...k];if(l){const[r,s]=l.split(",");a=He(a,r,s)}c=Re(a,e),o=Te(c,t,i),n({status:200,data:{list:o,pageInfo:{total:c.length,pageSize:t,pageNumber:i}}})})}function Oe(e){return new Promise(n=>{e.id=new Date().getTime(),k.push(e),n({status:200,data:{success:!0}})})}function ze(e){return new Promise(n=>{const t=k.findIndex(i=>i.id===e.id);t>-1&&(k[t]=e),n({status:200,data:{success:!0}})})}function Ne(e){return new Promise(n=>{for(let t=k.length-1;t>=0;t--){const i=k.findIndex(l=>e.some(c=>l.id===c));i>-1&&k.splice(i,1)}n({status:200,data:{success:!0}})})}function Te(e,n,t){return e.slice((t-1)*n,t*n)}function He(e,n,t){return e.sort((i,l)=>{const c=t==="asc"?[i,l]:[l,i],[o,a]=c.map(s=>s[n]);let r=o-a;return Number.isNaN(r)&&(r=o.localeCompare(a)),r})}function Re(e,n){let{name:t,beginDate:i,endDate:l,jit:c,region:o}=n;return t&&(e=e.filter(a=>a.name.indexOf(t)>-1)),i&&(e=e.filter(a=>a.beginDate.localeCompare(i)>=0)),l&&(e=e.filter(a=>a.endDate.localeCompare(l)<=0)),o&&(e=e.filter(a=>A(o,a.region))),c&&(e=e.filter(a=>A(c,a.jit))),e}function A(e,n){return!e||e.length===0?!0:e.some(t=>t==n)}const De=Object.freeze(Object.defineProperty({__proto__:null,createMarketing:Oe,listMarketing:Pe,removeMarketing:Ne,updateMarketing:ze},Symbol.toStringTag,{value:"Module"})),O=De;function mn(e){return O.listMarketing(e)}function Fe(e){return O.createMarketing(e)}function Le(e){return O.updateMarketing(e)}function pn(e){return O.removeMarketing(e)}const{TextArea:Ae}=B,{RangePicker:We}=$e;function _e(e){const[n]=C.useForm(),t=J(),i=Z(),l=de(ue),[c,o]=h.useState(!1),a={name:"",jit:!1};h.useEffect(()=>{r()});function r(){let u=t.pathname==="/form/update";e.isDialog&&(u=e.isUpdate),o(u),s(u)}function s(u){if(!u){n.resetFields();return}let m={...a};u&&l&&Ve(m,l),n.setFieldsValue(m)}function g(){x()}async function p(u){n.validateFields().then(()=>{const m=Ue(u);c?(m.id=l.id,b(m)):v(m)})}async function v(u){const S=await F(()=>Fe(u));y(S)}async function b(u){const S=await F(()=>Le(u));y(S)}function y(u){u.data.success&&(_.open({message:"操作成功"}),x())}function x(){n.resetFields(),e.isDialog?e.close():i("/table/basic")}return d.jsx("div",{style:{width:"600px",margin:"0 auto"},children:d.jsxs(C,{form:n,onFinish:p,...Be,children:[d.jsx(C.Item,{label:"活动名称",name:"name",rules:q.name,validateTrigger:"onBlur",children:d.jsx(B,{})}),d.jsx(C.Item,{label:"活动区域",name:"region",rules:q.region,children:d.jsx(ge,{options:[{label:"区域一",value:"shanghai"},{label:"区域二",value:"beijing"}]})}),d.jsx(C.Item,{label:"活动日期",name:"dateRange",rules:q.region,children:d.jsx(We,{format:P,style:{width:"100%"}})}),d.jsx(C.Item,{label:"即时配送",name:"jit",children:d.jsx(V,{})}),d.jsx(C.Item,{label:"活动性质",name:"type",rules:q.type,children:d.jsx(fe.Group,{options:Xe})}),d.jsx(C.Item,{label:"特殊资源",name:"resource",rules:q.resource,children:d.jsx(Se.Group,{options:Ke})}),d.jsx(C.Item,{label:"活动形式",name:"desc",children:d.jsx(Ae,{rows:5})}),d.jsx("div",{style:{textAlign:"center"},children:d.jsxs(be,{size:"middle",children:[d.jsx(D,{htmlType:"button",onClick:g,children:"取消"}),d.jsx(D,{type:"primary",htmlType:"submit",children:"提交"})]})})]})})}const Be={autoComplete:"off",labelCol:{span:3},wrapperCol:{span:21}},P="YYYY-MM-DD",q={name:[{required:!0,message:"请输入活动名称"},{min:3,max:20,message:"长度在 3 到 20 个字符"}],region:[{required:!0,message:"请选择活动区域"}],dateRange:[{required:!0,message:"请选择活动日期"}],type:[{required:!0,message:"请选择活动性质"}],resource:[{required:!0,message:"请选择活动资源"}]},Xe=[{label:"美食/餐厅线上活动",value:1},{label:"地推活动",value:2},{label:"线下主题活动",value:3},{label:"单纯品牌曝光",value:4}],Ke=[{label:"线上品牌商赞助",value:1},{label:"线下场地免费",value:2}];function Ve(e,n){Object.assign(e,n);const{beginDate:t,endDate:i}=n;e.dateRange=Ye(t,i),(e==null?void 0:e.type)!=null?e.type=e==null?void 0:e.type.split(",").map(Number):e.type=[],(e==null?void 0:e.jit)!=null?e.jit=Number(e==null?void 0:e.jit):e.jit=0}function Ue(e){const n=Ge(e.dateRange),t={...e,...n};return delete t.dateRange,t.type&&(t.type=t.type.join(",")),t.jit=t.jit?1:0,t}function Ye(e,n){return[T(e,P),T(n,P)]}function Ge(e){const[n,t]=e.map(i=>T(i).format(P));return{beginDate:n,endDate:t}}const fn=Object.freeze(Object.defineProperty({__proto__:null,default:_e},Symbol.toStringTag,{value:"Module"}));export{_e as B,fn as a,mn as l,pn as r,F as s};
